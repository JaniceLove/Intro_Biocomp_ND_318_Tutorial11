#Exercise 11
#Authors: Melissa Stephens and Janice Love
#Date: Nov. 10, 2017

#load packages 
import pandas as pd
import re 


#open files to read and write 
infile = open ("motifsort.fasta", 'r')
outfile1 = open ("motif1.sorted",'w')
outfile2 = open ("motif2.sorted", 'w')
outfile3 = open ("motif3.sorted", 'w')

#motif 1 == AKKPRVZE
#motif 2 == AAQWWRNYGG
motif_1 = re.compile(r"[A][K][K][P][R][V][Z][E]")
motif_2 = re.compile(r"[A][A][Q][W]+[R][N][Y][G]+")

for line in infile:
    line = line.strip()
    if line[0] == ">":
        ID = line 
    elif ">" != line:
        match = re.search(r"[A][K][K][P][R][V][Z][E]", line)
        if match == True:
                outfile1.write (ID + "\n")
                outfile1.write(line + "\n")
    elif motif_2.search(line):
        outfile2.write(ID + "\n")
        outfile2.write(line + "\n")
    else:
        outfile3.write(ID + "\n")
        outfile3.write(line + "\n")

            
infile.close()
outfile1.close()
outfile2.close()
outfile3.close()

